# semantic search owndata
tutorialでは英語の文章の検索をしたため、次は日本語データでやってみる。  

### TODO
- [x] 日本語データを用意する。属性値付きで。
- [x] qdrantで扱ってみる

## qdrantの利用設定
```
$ docker pull qdrant/qdrant
$ docker run -p 6333:6333 qdrant/qdrant
```

## コード
### データについて
個人で書いた読書のブログ記事のテキスト。  
1行目に読んだ本の発売年が「発売:XXXX」の形式でセットされている。

### embeddingモデル準備
```
from sentence_transformers import SentenceTransformer
encoder = SentenceTransformer("intfloat/multilingual-e5-small")
```

日本語対応の`intfloat/multilingual-e5-small`を利用。  

`query = "富を得るための方法が知りたいです。"`に対する結果。  

```
{'description': 'カネではなく、地位でもなく、富を求めよ。富とは、君が寝てる間も稼いでくれる資産だ。説明責任を引き受け、君の名のもとに事業リスクを取れ。社会はその見返りとして、君に責任、エクイティ、レバレッジを与えてくれる。自分をプロダクト化せよもし君が「富を得る」という目的を長期的にめざすなら、「今やっていることは自分らしいのか？自分らしさを発揮しているか？」と考えなくてはならない。それから、「プロダクト化しているか？スケール［規模を拡大］しているか？プロダクト化の手段はヒトか、カネか、コードか、メディアか？」と考えなくてはならない。だから君が富を得たいなら、社会が求めているが手に入れる方法がまだ知られていないものの中で、君にとって自然にできること、君のスキルセットを使ってできること、君の能力を使ってできることを見つけなくてはならない。私の言う「特殊知識を見つける」というのは、君が子どもの頃や10代の頃に苦もなくやっていたことを考えてみようということだ。君自身はスキルだとも思っていなかったが、身近な人が気づいていたことだ。君の母親や幼なじみはきっと知っている。君らしさで君に勝てる人はいない。今すでに得意でないのなら、夢中でないのなら、君には向いていないのかもしれないでも、君がそれに１００％のめり込んでいなければ、１００％のめり込んでいる誰かに負ける。「自分らしさで競争から抜け出せ」。君が人と競争しているときは、要するに人を模倣している。人と同じことをしているんだ。でも人はみな違う。模倣してはいけない。リッチになるための最重要スキルは、いつまでも学びつづける能力だ。学びたいことを何でも学べる力を身につけなくてはならない。努力のうち「1%」が身を結ぶ。これは９9%が無駄だと言いたいのではなく、慎重になる必要があると言うことを伝えたい。そして、その究極の目的は、複利(割合で増えるレバレッジポイント)を得るために全力を傾ける対象を見つけることだとわかってほしいからだ。私が言いたいのはこういうことだ。君のやっていることの中で無駄にならない１％が見つかったら──君が残りの人生を傾けられる対象、君にとって意味のある対象が見つかったら──ほかのことは忘れて、それに全身全霊を傾けよう。自分の名のもとに失敗するリスクを張れる人が、莫大な力を得るんだ。そしてレバレッジを持つ労働者にとって、仕事に費やす時間や労力よりはるかに重要なのが、「判断」だ。人と比べる癖がつくと、自分よりうまくやっている仲間を憎んだり、うらやんだり、ねたんだりしてしまう。そしてそういう感情は相手に伝わるものだ。君が誰かと仕事をしようとするとき、相手に悪意や偏見を持っていれば、その思いは相手に必ず伝わってしまう。人間は他人が心の奥底で思っていることを感じ取るようにできているんだ。だから人と比べることから抜け出さなくてはならない。君の人生では地位のゲームを避けなくてはならない──怒りに満ちた闘争的な人間になってしまうからだ。誰かを蹴落として、自分や自分に似た誰かを持ち上げるために、君はいつまでも戦いつづけるはめになる。キャリアの初期の人が（おそらくキャリア後期の人もだが）会社で働くときに考えるべき最重要ポイントは、その会社の出身者と将来どんなネットワークを築けるかだ。君の本当の履歴書とは、君が経験してきたすべての苦しみを並べたものだ。私にとっては、自分の行動が身のまわりの世界に長期的におよぼす影響を理解していることが、「知恵」だ。その知恵を外の世界に広げたものが、「判断」なんだ。知恵と判断は深く結びついている。自分の行動の長期的影響を知って、それを活かせるように正しい決定を下すことが大事だ。私にとっての幸福は欲望のない状態、とくに外的なものへの欲望がない状態だ。欲望が少なければ少ないほど、物事をあるがままに受け入れることができるし、心が雑念で揺れ動かなくなる。欲望とは、「欲しいものを手に入れるまで不幸でいます」という契約を自分自身と交わすことだ。ほとんどの人は、このことを自覚していないと思う。外的な問題なんて無限にある。だから心の平安を本当に得るには、何かが問題だという考えそのものを捨て去るしかないんだその人と完全に、四六時中、１００％入れ替わる覚悟がない限り、ねたんでも仕方がない。心の中で誰かを責めているのに気がついたら、自分を止めて「これをポジティブにとらえるとどうなるか？」と考えよう。誰かを批判すればするほど、君は孤立してしまう。その瞬間は気分がいい。自分のほうが優れていると考えて、自分に満足する。でもしばらくすると、孤独を感じる。何を見ても悪い面しか目に入らなくなる。世界は君の感情を照らし返す鏡なんだ。自分は幸福な人間だと、友人に宣言しよう。そうすると、その言葉に合わせて自然に幸福になれる。一貫性バイアスが働いて、自分の言動に一貫性を持たせようとするんだ。変えたい習慣を変える方法変えたい習慣を１つ選ぼう。変えたいと強く願おう。変わった自分を心に思い描こう。無理なく続けられる方法を考えよう。ニーズ、行動の引き金、代替行動を特定しよう。友人に宣言しよう。しっかり追跡しよう。Q: あなたにとって「受け入れる」とはどういう状態のことですか？A: どんな結果が出ても気にしないこと。君はいつか死に、すべてが意味を失う。だから楽しもう。前向きなことをしよう。愛を伝えよう。誰かを喜ばせよう。ちょっと笑おう。今この瞬間を味わおう。そして、君にしかできないことをしよう君らしさで君に勝る人は、世界に一人もいない。やらなくてはならないことは、つべこべ言わずにやろう。待つ必要がどこにある？待っていても若くはなれない。人生はどんどん過ぎていく。素晴らしいプロダクトを生み出すには、長い時間をかけて磨き抜かなければならない。行動は性急に、結果には寛大に、だ。Q: お子さんに自分の信条を１つか2つ伝えるとしたら何ですか？A: 第一が、読め。第二に、数学スキルと説得術を身につけろ。どちらも、実社会を渡っていくのに役立つスキルだ。', 'title': 'シリコンバレー最重要思想家ナヴァル・ラヴィカント', 'year': '2022'} score: 0.8747503
{'description': 'そもそも交渉とはなんのために行うのかといえば、複数の人間が話し合い、合意を結ぶことで、「現実を動かしていく」ためです。「いつしか交渉もコンピュータが人間に代わって行うようになるのではないか？」と思われるかもしれません。しかし私は、どれだけコンピュータが進歩しても、交渉ができるようにはならないだろう、と考えています。 なぜならば交渉には、「ロマン」と「ソロバン」という２つの側面があるからです。本当に世の中を動かそうと思うのであれば、いまの社会で権力や財力を握っている人たちを味方につけて、彼らの協力を取りつけることが絶対に必要となってくるわけです。人は漠然としたものにはお金を払いません。一方で、具体的に「メリット」が実感できる提案には、お金を払ってくれます。ロマンは長期的で抽象的でもかまいません。むしろ大きすぎるぐらいのほうが魅力的かもしれない。しかし、ソロバンはできるだけ具体的で、短期的に結果がわかることが望ましいわけです。「すごく合理的に物事を判断する人を相手とする交渉」と、「まったく合理的でない人を相手とする交渉」の２つに分けて考えていきたいと思います。なぜ相手を分けて考える必要があるかというと、交渉では意思決定権を持つ相手と自分とが合意することが必要不可欠なので、相手がどういう考え方をするか知らないと、そもそも交渉が成り立たないからです。相手に交渉のテーブルについてもらうためには、「自分の立場を理解してもらう」ことより、「相手の立場を理解すること」の方が大切です。つまり、「僕が可愛そうだからどうにかして！」ではなく、「あなたがこうすると得ですよね。」という提案をすべきなのです。バトナとは、「Best Alternative to a Negociated Agreement」の略。目の前の交渉相手と合意する以外にいくつかの選択肢があったときに、交渉相手に「私はあなたと合意をしなくても別の良い選択肢があるので、それよりも良い条件でなければ合意しない」と宣言できる他の選択肢のこと。交渉においては「自分の本当のバトナ」を相手に悟られてはいけない。ビジネスというのは本来、取引が成立したらすべて「ウィンウィン」であるべきです。交渉に合意したということは、お互いにとって納得いく結果となったということですから、むしろウィンウィンでなければなりません。だから問題とすべきは「どれくらいウィンか？」ということです。こと交渉においては、「どちらかのビッグウィンは、もう一方のスモールウィン」であることをよく覚えておいてください。バトナ(別のより良い選択肢を持った交渉)を活用する際、心理的なハードルが存在する。この心理的なハードルを乗り越えるのが、結構大変だったりする。そこでお勧めなのが、交渉を「自分のことだとは思わずに、代理人として交渉を頼まれた」とマインドを切り替えること。自分が交渉するときも、自分のなかで「交渉する人」「分析する人」「意思決定する人」を分けてみるのはきわめて有効でしょう。相手側に何かしら強く押し切られて合意を求められそうになったら、そこで「ちょっと持ち帰ってパートナーと相談してから決めさせてください」と言ってみる。実際にパートナーなんていなくてもかまいません。とにかく相手に「自分だけでは決められない」と伝えることが大切で、持ち帰ってじっくり状況を分析する時間をとることで、その場での不用意な合意を避けられるのです。世間では交渉が強い人というと、声が大きくて押しが強い人をイメージしますが、そういう人よりも、むしろじっと相手の話を聞いて、冷静に分析してゲームのように有効なカードを切れる人のほうが強いというのが、交渉の常識です。アンカリングとは、船を停泊させる際に錨（アンカー）を打つことからきています。ひと言でいえば、錨とも言うべき「最初の提示条件」（これを交渉用語ではアンカーと呼びます）によって、交渉相手の認識をコントロールすること。交渉はスタート地点ですでにある程度の結果が決まってしまうことが多々あるのです。アンカリングにおいて最初に提示する条件は、できるだけ「高い目標」とすることが大切です。なぜならば、最終的に交渉の結果得られる果実は、最初に置いた目標以上にはならないからです。継続的に市場で勝ち続けるためには、「あまり暴利を貪らない」ということがじつは重要です。相手の利害関係を分析・理解し、それを満たしながら、さりげなく自分の要望も実現するのが、賢い交渉のポイントとなります。交渉時の注意点について、とくに大事なものを２つだけお伝えしたいと思います。１つ目は、「沈黙に耐える」ということです。２つ目の注意点は、「相手が情報を出してこないときは、そのこと自体を利用する」ということです。非合理的な人間との交渉時の６つのタイプ①「価値理解と共感」を求める人②「ラポール」を重視する人③「自律的決定」にこだわる人④「重要感」を重んじる人⑤「ランク主義者」の人⑥「動物的な反応」をする人①「価値理解と共感」を求める人自分だけの独自の価値観、あるいは個人的な信念を並外れて持っていて、利害関係よりも重視するタイプ。このタイプと交渉するときには、相手の価値観に合わせなければならない。相手の言動からその人の価値観を探っていくときのポイントとして、「人の価値観とは固有のものであり、それを他人が変えることはできないから、認めるしかない」ということを押さえておきましょう。②「ラポール」を重視する人ラポールとは信頼関係のことで、信頼を得ていない人との交渉に慎重になるタイプ。このタイプと交渉するときには、２つのポイントがある。１つ目は、「好意の返報性」という人間心理に働きかけることです。「この人とはどうしても信頼関係を築きたい」と思ったら、まずはその人のことを心から好きになってみる。そうすると、自然にそれが自分の態度に表れ、相手にも伝わります。２つ目は、「スモールギフトを贈る」。３つ目は、「相手と似た境遇を発見して会話の糸口を探る」。４つ目は、「相手の好む話し方で付き合う」。５つ目は、交渉のプロセスの中で「共同作業の時間をもつ」。③「自律的決定」にこだわる人客観的に正しいかどうかよりも、「自分で決めた」ということに重きを置くタイプ。交渉相手がこのタイプであれば、説得は諦めたほうが良いでしょう。相手が、自分で判断・決定するための材料を提供することに徹することが有効です。この際、リテラシーが高い相手に対しては、メリットとデメリットの両方の情報を渡すと喜ばれます。④「重要感」を重んじる人相手が自分のことを「より重く」「より大切に」してくれているかを大切にするタイプ。このタイプには、反応速度を速くすることが有効。⑤「ランク主義者」の人学歴や肩書などを重要視するタイプ。より高いランクで迎え撃つか、そのランクのあなたの力が社会課題の解決にどうしても必要なんです。という形での対応が有効。⑥「動物的な反応」をする人感情が先に立つタイプ。このタイプは、交渉時に相手が疲れていそうだったらリスケするなどが良い。また、ネガティブな反応がある場合、それに付き合わないようにする。', 'title': '武器としての交渉思考', 'year': '2012'} score: 0.8558407
{'description': '勝ち続ける、というのは、つまり成長し続けているということです。同時に、決して誤解してほしくないのは、ある時点での実力差、能力差は、その後の成長力で必ず埋められるということです。これは、どんな世界でも共通していることだと思います。しかし本当は、他人に勝つことではなく、成長することが勝利である。常に目を切らさないようにしているのは、自分自身の成長である。そして、自分が成長の軌道に乗っているかどうかの確認作業だ。どうしても目標という言葉を使うのなら、「毎日、来る日も来る日も、自分を成長させるリズムを維持すること」が該当する。それが一番大切なことだからだまず、僕が強く勧めたいのは、効率を最優先しないことだ。基礎固めの段階こそ、たとえ最初のうちはボロボロに負けようと、人から笑われようと、納得て切るまでじっくり時間をかけて回り道して考え、あえて定石やセオリーとされるものを疑い、時には崩してみる。自分で体験し、体験を通して学んでみる。そして、セオリーの意味を自分で再発見する。大切なのは「自分が何ができないから結果が出せないのか？」という考え方である。僕の考える、ちょうどいい負荷の設定条件とは、「意識すればできるが、意識しないとできないこと」といった表現になる。その辺のレベルにある動作を、徹底的に学ぶのだ。失敗から得るものの方が大きいということを知ると、反省が最高に気持ちいい作業になる。僕は、たとえ自分で考えた知識、編み出した技術であろうと、隠すことが好きではない。どうせ使えば見えてしまう。見えてしまう部分を真似されることは一向に構わないし、質問されればいくらでも答える。隠そうとする自分が嫌いだからだ。むしろ、個性は出そうと思って出るものではなく、「個性的でありたい」と考えることはかえって危険であるとも言える。僕の見てきた経験からは、早いうちから個性を出したがる人ほど、成長が遅くなってしまう傾向があるように思う。何を隠そう、僕自身も初めはそうだった。思考する際、決してしてはいけないことがある。それは、自分を人と比べないことだ。自分自身が成長し続けることと同時に、成長し続けている事実を自分で把握することも大切な能力だと考えている。「ネガティブな感情をコントロールすることの必要性」だ。これは、目先のパフォーマンス向上だけでなく、最後は直接幸福感を上昇させるための、勝ち続ける為の原動力になるのではないかと思うのだ。まず、大前提として、ネガティブな感情の発生そのものは抑えられないことを知ってほしい。嫌なことに直面したら気分が滅入る。理不尽なことに接すれば、頭にくるし腹も立つ。それ自体は抑えられない自然な現象だ。だから、そうした負の感情をコントロールすることが大切になってくる。従って、ここでいうコントロールとは、悲しむな、腹を立てるな、ということではない。表に出さないようコントロールしようということなのだ。感情を表に出す基準を変化させてみる、という言い方でもいいだろう。勝ちづつけるメンタルを考えるとき、絶対に避けて通れない道がある。それは「孤独に耐える」ことだ。しかし、多くの人は孤独そのものに耐えられなくなる。確かにひとりぼっちは寂しい。人と繋がりたくなる。でも、踏ん張りどころは、そこにある。努力することに、成長を続けることは、それ自体が幸福感に直結している。だから、成果を求めてはいけないし、成果が必ず出るなんて考えるのは驕りそのものだ。むしろ安心感や充実感は、ずっと成長し続けていることだけによって得られる。今成長し続けていれば、きっとこの先だって大丈夫だ。そしてそう思えることそのものが幸せの形だと思う。それこそが報われている状態なのだ。', 'title': '勝負論_ウメハラの流儀', 'year': '2013'} score: 0.85039854
```